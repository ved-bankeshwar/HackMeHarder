- id: PY-CMD-INJ-001
  name: "Command Injection: Subprocess with shell=True"
  type: "Command Injection"
  detection:
    # We are looking for a function call node in the AST
    node_type: "Call"
    # The function being called must be an attribute of an object (e.g., subprocess.run)
    function_is_attribute: True
    # Conditions for the function call
    function_call_properties:
      object_name: "subprocess"
      # We check for a specific dangerous keyword argument
      keyword_argument:
        name: "shell"
        value: True

- id: PY-CMD-INJ-002
  name: "Command Injection: os.system call"
  type: "Command Injection"
  detection:
    node_type: "Call"
    function_is_attribute: True
    function_call_properties:
      object_name: "os"
      function_name: "system"

- id: PY-SQLI-001
  name: "SQL Injection: Unsafe string in execute"
  type: "SQL Injection"
  detection:
    node_type: "Call"
    function_is_attribute: True
    function_call_properties:
      function_name: "execute"
    # Check the properties of the arguments passed to the function
    argument_properties:
      # The first argument (position 0) must be an f-string or a concatenated string
      - position: 0
        is_formatted_string: True